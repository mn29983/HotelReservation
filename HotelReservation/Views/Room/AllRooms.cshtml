@model List<Room>




<form method="get" action="@Url.Action("AllRooms")">
    <label for="checkIn">Check In:</label>
    <input type="date" name="checkIn" />

    <label for="checkOut">Check Out:</label>
    <input type="date" name="checkOut" />

    <button type="submit">Check Availability</button>
</form>

@functions {
    private bool IsRoomAvailable(Room room, DateTime checkIn, DateTime checkOut)
    {
        // Check if the room is available within its availability range
        if (checkIn >= room.AvailableFrom && checkIn <= DateTime.MaxValue)
        {
            // Check if there are any reservations that overlap with the specified dates
            return !room.Reservations.Any(r => (checkIn < r.CheckOut && checkOut > r.CheckIn));
        }

        return false;
    }
}


@foreach (var room in Model)
{
    <div>
        <h3>Room: @room.RoomNumber</h3>
        <p>Type: @room.Type</p>
        <p>Description: @room.Description</p>
        <p>Capacity: @room.Capacity</p>
        <p>Price: @room.Price</p>
        <p>
            @if (IsRoomAvailable(room, DateTime.Today, DateTime.MaxValue))
            {
                <text>Available: Yes</text>
            }
            else
            {
                <text>Not available</text>
            }
        </p>
        <p><a href="@Url.Action("Create", "Reservation", new { roomId = room.Id })">Reserve</a></p>

        @if (IsRoomAvailable(room, DateTime.Today, DateTime.MaxValue))
        {
            <form method="get" action="@Url.Action("MakeReservation", "Reservation")">
                <input type="hidden" name="roomId" value="@room.Id" />
                <label for="checkIn">Check In:</label>
                <input type="date" name="checkIn" />

                <label for="checkOut">Check Out:</label>
                <input type="date" name="checkOut" />

                <button type="submit">Reserve</button>
            </form>
        }
        else
        {
            <p>Not available</p>
        }
    </div>
}

