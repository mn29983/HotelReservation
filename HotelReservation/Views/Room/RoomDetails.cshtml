@model HotelReservation.Models.Room

<script>
    $(function () {
        var dateFormat = "dd-mm-yy"; // Update the date format

        var from = $("#from").datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            dateFormat: dateFormat // Set the date format
        }).on("change", function () {
            to.datepicker("option", "minDate", getDate(this));
        });

        var to = $("#to").datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            dateFormat: dateFormat // Set the date format
        }).on("change", function () {
            from.datepicker("option", "maxDate", getDate(this));
        });

        function getDate(element) {
            var date;
            try {
                date = $.datepicker.parseDate(dateFormat, element.value);
            } catch (error) {
                date = null;
            }

            return date;
        }
    });
</script>

<h2>Room Details</h2>

<div class="container mt-4">
    <div class="row">
        <!-- Images on the left side -->
        <div class="col-md-6">
            <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="@Model.PictureUrl1" class="d-block w-100" alt="First Picture">
                    </div>
                    <div class="carousel-item">
                        <img src="@Model.PictureUrl2" class="d-block w-100" alt="Second Picture">
                    </div>
                    <div class="carousel-item">
                        <img src="@Model.PictureUrl3" class="d-block w-100" alt="Third Picture">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>

        <!-- Information on the right side -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Room @Model.RoomNumber</h5>
                    <p class="card-text">
                        Type: @Model.Type <br />
                        Description: @Model.Description <br />
                        Capacity: @Model.Capacity <br />
                        Price: @Model.Price <br />
                        Available: @Model.Available
                    </p>
                </div>
            </div>
            <h4>Amenities:</h4>
            <ul>
                @foreach (var amenity in Model.Amenities)
                {
                    <li>@Enum.GetName(typeof(HotelReservation.Models.Amenities), amenity)</li>
                }
            </ul>

            <!-- Date Pickers -->
             @if (User.Identity.IsAuthenticated)
            {
                <div class="mt-4">
                    <label for="from">From Date:</label>
                <input type="text" id="from" name="from" min="@DateTime.Now.ToString("dd-MM-yyyy")">

                <label for="to">To Date:</label>
                <input type="text" id="to" name="to" min="@DateTime.Now.ToString("dd-MM-yyyy")">

                <button id="reserveButton" class="btn btn-primary ml-4">Reserve Room</button>
            </div>
            }
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('#reserveButton').on('click', function () {
            var from = $('#from').val();
            var to = $('#to').val();

            // Send the selected dates to the server for reservation
            $.ajax({
                type: 'POST',
                url: '/Room/ReserveRoom',
                data: { roomId: @Model.RoomId, from: from, to: to },
                success: function (result) {
                    // Handle success, e.g., show a success message
                    console.log(result);
                },
                error: function (error) {
                    // Handle error, e.g., show an error message
                    console.error(error);
                }
            });
        });
    });
</script>